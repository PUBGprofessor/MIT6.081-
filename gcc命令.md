## Linux下：

## 一、编译过程

> 在使用gcc编译程序时，编译过程可以简要划分为4个阶段：
>
> 1. 预处理
> 2. 汇编
> 3. 编译
> 4. 链接

### 一）预处理（Pre-processing）

>这个阶段主要处理源文件中的#indef、#include和#define预处理命令；
>这里主要是把一些include的头文件和一些宏定义，放到源文件中。

- 输入的是**C语言的源文件**

- 输出 ：生成一个中间/**预加载文件 *.i**（以 .i 结尾的文件）

- 这个阶段对应的gcc命令如下：

  ``` bash
  #gcc –E（预处理） test.c（源文件） -o test.i（将结果生成的文件）
  ```

- 说明：它通过对源文件test.c使用E选项来生成中间文件test.i

### 二）汇编(Assembling)
输入：**预处理文件*.i**

输出：编译后生成**汇编编语言文件*.s**

这个阶段对应的gcc命令如下：

```bash
gcc -S(汇编) test.i -o test.s（汇编编语言文件）
```

说明：它通过对源文件test.c使用S选项来生成汇编文件test.s

###  三）编译(Compiling)
输入文件：**汇编文件*.s**
输出文件：**二进制机器代码*.o**
这个阶段对应的gcc命令如下：

~~~bash
gcc -c（编译） test.s -o test.o
~~~

### 四）gcc -c

> 在功能上，预处理、编译、汇编是3个不同的阶段
> 但gcc在实际操作时可以把这3个步骤合并为一个步骤来执行,即使用 -c选项：

输入文件：**源码*.c文件**
输出文件：**二进制机器代码*.o**
这个阶段对应的gcc命令如下：

```bash
gcc –c test.c -o test.o
```

// -o指定了output_filename
或 ：

```bash
gcc -c test.c
```

//省略-o output_filename
//默认输出为**test.o**
//与源文件同名，后缀为.o

### 五）链接(Linking)

- 输入文件：二进制机器码*.o文件
- 输出文件：与其它的机器代码和库文件汇集成一个**可执行的**二进制代码文件（无后缀）
- 这个阶段对应的gcc命令如下：

````bash
gcc （没有选项符号） test.o example.o -o test
````

> 可用选项  (?)：
> -L 指定库路径
> -l （小写的L）指定库名称
> -I （大写的i）指定头文件所在路径
> -i 指定头文件名称

### 六）简化过程 —— gcc

- 上述过程可以简化为：

````bash
gcc test.c （源文件） -o test（可执行文件）
````

